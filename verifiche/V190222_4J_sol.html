<form name="tablegen">
    <label>Rows: <input type="text" name="rows" id="rows"/></label><br />

    <input name="generate" type="button" value="Create Table!" onclick='createTable();'/>
</form>

<div id="wrapper"></div>
<div id="total"></div>

<script type="text/javascript">

    function createTable()
    {
        var sum = 0;
        var num_rows = document.getElementById('rows').value;
        var theader = '<table border="">\n';
        var tbody = '';
        var randomNumber = function (min, max)
        {
            return Math.floor (Math.random() * (max - min + 1)) + min;
        }

        for( var i=0; i<num_rows;i++)
        {
            tbody += '<tr>';
            for( var j=0; j<num_rows;j++)
            {
                var ranNum = randomNumber(1,100);
                var color;
                sum = sum + ranNum;
                if(ranNum % 3 == 0) {
                    color = 'red';
                } else if(ranNum % 2 == 0) {
                    color = 'blue';
                } else {
                    color = 'white';
                }
                tbody += '<td style="background-color:' + color + '">';
                tbody += ' ' + ranNum;
                tbody += '</td>'

            }
            tbody += '</tr>\n';
        }

        var tfooter = '</table>';
        document.getElementById('wrapper').innerHTML = theader + tbody + tfooter;
        document.getElementById('total').innerHTML = "Total: " + sum;
    }
</script>
